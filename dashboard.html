<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - English Learning SMP</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #333;
    }

    .dashboard-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    .dashboard-header {
      background: white;
      border-radius: 20px;
      padding: 30px;
      margin-bottom: 30px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .dashboard-header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 5px;
      background: linear-gradient(90deg, #3498db, #2ecc71, #e74c3c, #f39c12);
      animation: gradientMove 3s ease-in-out infinite;
    }

    @keyframes gradientMove {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .user-welcome {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .user-avatar-large {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: linear-gradient(135deg, #3498db, #2ecc71);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 36px;
      color: white;
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    .user-info {
      text-align: left;
    }

    .user-name {
      font-size: 28px;
      font-weight: bold;
      color: #2c3e50;
      margin-bottom: 5px;
    }

    .user-level {
      font-size: 16px;
      color: #7f8c8d;
      margin-bottom: 10px;
    }

    .user-stats {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
    }

    .stat-badge {
      background: linear-gradient(135deg, #f39c12, #e67e22);
      color: white;
      padding: 8px 15px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: bold;
    }

    .logout-btn {
      position: absolute;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, #e74c3c, #c0392b);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 20px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s;
    }

    .logout-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(231, 76, 60, 0.3);
    }

    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 25px;
      margin-bottom: 30px;
    }

    .feature-card {
      background: white;
      border-radius: 20px;
      padding: 30px;
      text-align: center;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .feature-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      transition: all 0.3s;
    }

    .feature-card.vocab::before {
      background: linear-gradient(90deg, #3498db, #2ecc71);
    }

    .feature-card.listening::before {
      background: linear-gradient(90deg, #9b59b6, #8e44ad);
    }

    .feature-card.quiz::before {
      background: linear-gradient(90deg, #e74c3c, #c0392b);
    }

    .feature-card.leaderboard::before {
      background: linear-gradient(90deg, #f39c12, #e67e22);
    }

    .feature-card:hover {
      transform: translateY(-10px);
      box-shadow: 0 20px 40px rgba(0,0,0,0.15);
    }

    .feature-card:hover::before {
      height: 8px;
    }

    .feature-icon {
      font-size: 60px;
      margin-bottom: 20px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .feature-title {
      font-size: 24px;
      font-weight: bold;
      color: #2c3e50;
      margin-bottom: 15px;
    }

    .feature-desc {
      color: #7f8c8d;
      margin-bottom: 25px;
      line-height: 1.6;
    }

    .feature-btn {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      padding: 12px 25px;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      font-weight: bold;
      text-decoration: none;
      display: inline-block;
      transition: all 0.3s;
      position: relative;
      overflow: hidden;
    }

    .feature-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: left 0.5s;
    }

    .feature-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
    }

    .feature-btn:hover::before {
      left: 100%;
    }

    .progress-section {
      background: white;
      border-radius: 20px;
      padding: 30px;
      margin-bottom: 30px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }

    .progress-title {
      font-size: 24px;
      font-weight: bold;
      color: #2c3e50;
      margin-bottom: 25px;
      text-align: center;
    }

    .progress-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
    }

    .progress-item {
      text-align: center;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 15px;
      transition: all 0.3s;
    }

    .progress-item:hover {
      background: #e9ecef;
      transform: translateY(-5px);
    }

    .progress-number {
      font-size: 36px;
      font-weight: bold;
      color: #3498db;
      margin-bottom: 10px;
    }

    .progress-label {
      color: #7f8c8d;
      font-size: 14px;
    }

    .achievements-section {
      background: white;
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }

    .achievements-title {
      font-size: 24px;
      font-weight: bold;
      color: #2c3e50;
      margin-bottom: 25px;
      text-align: center;
    }

    .achievements-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 15px;
    }

    .achievement-badge {
      background: linear-gradient(135deg, #f39c12, #e67e22);
      color: white;
      padding: 20px;
      border-radius: 15px;
      text-align: center;
      transition: all 0.3s;
      cursor: pointer;
    }

    .achievement-badge:hover {
      transform: scale(1.05);
      box-shadow: 0 10px 25px rgba(243, 156, 18, 0.3);
    }

    .achievement-icon {
      font-size: 30px;
      margin-bottom: 10px;
    }

    .achievement-name {
      font-size: 12px;
      font-weight: bold;
    }

    .quick-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }

    .quick-stat {
      background: white;
      padding: 20px;
      border-radius: 15px;
      text-align: center;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      transition: all 0.3s;
    }

    .quick-stat:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0,0,0,0.15);
    }

    .quick-stat-number {
      font-size: 24px;
      font-weight: bold;
      color: #3498db;
      margin-bottom: 5px;
    }

    .quick-stat-label {
      font-size: 12px;
      color: #7f8c8d;
    }

    @media (max-width: 768px) {
      .dashboard-container {
        padding: 15px;
      }

      .dashboard-header {
        padding: 20px;
      }

      .user-welcome {
        flex-direction: column;
        text-align: center;
      }

      .user-info {
        text-align: center;
      }

      .user-stats {
        justify-content: center;
      }

      .logout-btn {
        position: static;
        margin-top: 20px;
      }

      .dashboard-grid {
        grid-template-columns: 1fr;
        gap: 20px;
      }

      .feature-card {
        padding: 25px;
      }
    }
  </style>
</head>
<body>
  <div class="dashboard-container">
    <!-- Dashboard Header -->
    <div class="dashboard-header">
      <button class="logout-btn" onclick="logout()">🚪 Keluar</button>
      
      <div class="user-welcome">
        <div class="user-avatar-large" id="userAvatar">👤</div>
        <div class="user-info">
          <div class="user-name" id="userName">Selamat Datang!</div>
          <div class="user-level" id="userLevel">Level Beginner</div>
          <div class="user-stats">
            <div class="stat-badge">📊 Skor: <span id="userScore">0</span></div>
            <div class="stat-badge">🔥 Streak: <span id="userStreak">0</span> hari</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Quick Stats -->
    <div class="quick-stats">
      <div class="quick-stat">
        <div class="quick-stat-number" id="totalQuizzes">0</div>
        <div class="quick-stat-label">Quiz Selesai</div>
      </div>
      <div class="quick-stat">
        <div class="quick-stat-number" id="totalVocab">0</div>
        <div class="quick-stat-label">Vocab Dikuasai</div>
      </div>
      <div class="quick-stat">
        <div class="quick-stat-number" id="totalListening">0</div>
        <div class="quick-stat-label">Listening Selesai</div>
      </div>
      <div class="quick-stat">
        <div class="quick-stat-number" id="currentRank">-</div>
        <div class="quick-stat-label">Peringkat</div>
      </div>
    </div>

    <!-- Main Features -->
    <div class="dashboard-grid">
      <div class="feature-card vocab">
        <div class="feature-icon">📖</div>
        <div class="feature-title">Vocabulary Harian</div>
        <div class="feature-desc">
          Pelajari kosakata baru setiap hari dengan sistem flashcard interaktif dan pronunciation guide.
        </div>
        <a href="vocab.html" class="feature-btn">Mulai Belajar</a>
      </div>

      <div class="feature-card listening">
        <div class="feature-icon">🎧</div>
        <div class="feature-title">Listening Practice</div>
        <div class="feature-desc">
          Asah kemampuan mendengar dengan berbagai audio conversation dan exercise yang menarik.
        </div>
        <a href="listening.html" class="feature-btn">Mulai Latihan</a>
      </div>

      <div class="feature-card quiz">
        <div class="feature-icon">✍️</div>
        <div class="feature-title">Grammar & Writing</div>
        <div class="feature-desc">
          Uji pemahaman grammar dan writing skills dengan quiz interaktif dan feedback langsung.
        </div>
        <a href="quiz.html" class="feature-btn">Mulai Quiz</a>
      </div>

      <div class="feature-card leaderboard">
        <div class="feature-icon">🏆</div>
        <div class="feature-title">Leaderboard</div>
        <div class="feature-desc">
          Lihat peringkat Anda dan bersaing dengan siswa lain untuk menjadi yang terbaik.
        </div>
        <a href="leaderboard.html" class="feature-btn">Lihat Peringkat</a>
      </div>
    </div>

    <!-- Progress Section -->
    <div class="progress-section">
      <div class="progress-title">📈 Progress Belajar Anda</div>
      <div class="progress-grid">
        <div class="progress-item">
          <div class="progress-number" id="progressVocab">0%</div>
          <div class="progress-label">Vocabulary Progress</div>
        </div>
        <div class="progress-item">
          <div class="progress-number" id="progressListening">0%</div>
          <div class="progress-label">Listening Progress</div>
        </div>
        <div class="progress-item">
          <div class="progress-number" id="progressGrammar">0%</div>
          <div class="progress-label">Grammar Progress</div>
        </div>
        <div class="progress-item">
          <div class="progress-number" id="overallProgress">0%</div>
          <div class="progress-label">Overall Progress</div>
        </div>
      </div>
    </div>

    <!-- Achievements Section -->
    <div class="achievements-section">
      <div class="achievements-title">🏅 Achievement Terbaru</div>
      <div class="achievements-grid" id="achievementsContainer">
        <!-- Achievements will be populated by JavaScript -->
      </div>
    </div>
  </div>

  <script>
    class Dashboard {
      constructor() {
        this.currentUser = JSON.parse(localStorage.getItem("currentUser"));
        this.init();
      }

      init() {
        // Check if user is logged in
        if (!this.currentUser) {
          window.location.href = 'index.html';
          return;
        }

        this.loadUserData();
        this.updateUI();
        this.loadProgress();
        this.loadAchievements();
        this.calculateRank();
      }

      loadUserData() {
        // Update user info
        document.getElementById('userName').textContent = `Selamat Datang, ${this.currentUser.name}!`;
        document.getElementById('userLevel').textContent = `Level ${this.currentUser.level || 'Beginner'}`;
        document.getElementById('userScore').textContent = this.currentUser.score || 0;
        document.getElementById('userStreak').textContent = this.currentUser.streak || 0;
        
        // Set avatar
        const avatar = this.getAvatarIcon(this.currentUser.name);
        document.getElementById('userAvatar').textContent = avatar;
      }

      updateUI() {
        // Update quick stats
        document.getElementById('totalQuizzes').textContent = this.currentUser.completedQuizzes || 0;
        document.getElementById('totalVocab').textContent = this.currentUser.vocabularyMastered || 0;
        document.getElementById('totalListening').textContent = this.currentUser.listeningCompleted || 0;
      }

      loadProgress() {
        const vocabProgress = Math.min(((this.currentUser.vocabularyMastered || 0) / 24) * 100, 100);
        const listeningProgress = Math.min(((this.currentUser.listeningCompleted || 0) / 15) * 100, 100);
        const grammarProgress = Math.min(((this.currentUser.completedQuizzes || 0) / 17) * 100, 100);
        const overallProgress = Math.round((vocabProgress + listeningProgress + grammarProgress) / 3);

        // Animate progress numbers
        this.animateNumber('progressVocab', 0, Math.round(vocabProgress), '%');
        this.animateNumber('progressListening', 0, Math.round(listeningProgress), '%');
        this.animateNumber('progressGrammar', 0, Math.round(grammarProgress), '%');
        this.animateNumber('overallProgress', 0, overallProgress, '%');
      }

      animateNumber(elementId, start, end, suffix = '') {
        const element = document.getElementById(elementId);
        const duration = 2000;
        const stepTime = 50;
        const steps = duration / stepTime;
        const increment = (end - start) / steps;
        let current = start;

        const timer = setInterval(() => {
          current += increment;
          if (current >= end) {
            element.textContent = end + suffix;
            clearInterval(timer);
          } else {
            element.textContent = Math.round(current) + suffix;
          }
        }, stepTime);
      }

      loadAchievements() {
        const achievements = this.currentUser.achievements || [];
        const container = document.getElementById('achievementsContainer');
        
        if (achievements.length === 0) {
          container.innerHTML = `
            <div style="grid-column: 1 / -1; text-align: center; color: #7f8c8d; padding: 20px;">
              Belum ada achievement. Mulai belajar untuk mendapatkan badge pertama Anda! 🎯
            </div>
          `;
        } else {
          container.innerHTML = achievements.map(achievement => `
            <div class="achievement-badge" title="${achievement.description}">
              <div class="achievement-icon">${achievement.icon}</div>
              <div class="achievement-name">${achievement.name}</div>
            </div>
          `).join('');
        }
      }

      calculateRank() {
        const leaderboard = JSON.parse(localStorage.getItem("leaderboard")) || [];
        const sorted = leaderboard.sort((a, b) => b.score - a.score);
        const userIndex = sorted.findIndex(user => user.username === this.currentUser.username);
        
        if (userIndex !== -1) {
          document.getElementById('currentRank').textContent = `#${userIndex + 1}`;
        } else {
          document.getElementById('currentRank').textContent = '-';
        }
      }

      getAvatarIcon(name) {
        if (!name) return '👤';
        
        const icons = ['🧑‍🎓', '👨‍🎓', '👩‍🎓', '🎓', '📚', '✨', '🌟', '🚀'];
        const index = name.charCodeAt(0) % icons.length;
        return icons[index];
      }
    }

    function logout() {
      if (confirm('Yakin ingin keluar? Progress yang belum tersimpan akan hilang.')) {
        localStorage.removeItem("currentUser");
        
        // Show logout notification
        showNotification('Berhasil keluar! Sampai jumpa lagi! 👋', 'info');
        
        setTimeout(() => {
          window.location.href = 'index.html';
        }, 1500);
      }
    }

    function showNotification(message, type = 'info') {
      const colors = {
        success: 'linear-gradient(135deg, #27ae60, #2ecc71)',
        error: 'linear-gradient(135deg, #e74c3c, #c0392b)',
        info: 'linear-gradient(135deg, #3498db, #2980b9)',
        warning: 'linear-gradient(135deg, #f39c12, #e67e22)'
      };
      
      const icons = {
        success: '✅',
        error: '❌',
        info: 'ℹ️',
        warning: '⚠️'
      };
      
      const notification = document.createElement('div');
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: ${colors[type]};
        color: white;
        padding: 15px 20px;
        border-radius: 10px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        z-index: 10000;
        font-family: Arial, sans-serif;
        animation: slideInRight 0.5s ease-out;
        max-width: 300px;
      `;
      
      notification.innerHTML = `<div style="font-weight: bold;">${icons[type]} ${message}</div>`;
      document.body.appendChild(notification);
      
      setTimeout(() => {
        if (notification.parentNode) {
          notification.parentNode.removeChild(notification);
        }
      }, 3000);
    }

    // Add animation styles
    const style = document.createElement('style');
    style.textContent = `
      @keyframes slideInRight {
        from {
          transform: translateX(100%);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }
    `;
    document.head.appendChild(style);

    // Initialize dashboard
    new Dashboard();
  </script>
</body>
</html>